```python
! pip install nltk
! pip install tqdm
! pip install numpy
! pip install pandas
```

    Requirement already satisfied: nltk in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (3.4)
    Requirement already satisfied: six in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (from nltk) (1.16.0)
    Requirement already satisfied: singledispatch in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (from nltk) (3.7.0)
    Requirement already satisfied: tqdm in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (4.64.1)
    Requirement already satisfied: colorama in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (from tqdm) (0.4.6)
    Requirement already satisfied: numpy in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (1.23.5)
    Requirement already satisfied: pandas in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (1.5.2)
    Requirement already satisfied: python-dateutil>=2.8.1 in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (from pandas) (2.8.2)
    Requirement already satisfied: numpy>=1.20.3 in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (from pandas) (1.23.5)
    Requirement already satisfied: pytz>=2020.1 in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (from pandas) (2022.6)
    Requirement already satisfied: six>=1.5 in d:\education\master\semesters\semester 3\nlp\hws\2\kohan\venv\lib\site-packages (from python-dateutil>=2.8.1->pandas) (1.16.0)
    


```python
import nltk
import codecs
import tqdm

# Read text
GAZALS_FILE_PATH = 'all_qazals_mesra.txt'
mesra_collection = codecs.open(GAZALS_FILE_PATH,'rU','utf-8').readlines()

# Select part of that
mesra_collection = mesra_collection[40:100]
```


```python
from hazm import Normalizer

# Normalizer on qazals collection
normalizer = Normalizer(token_based=True, kohan_style=True)
mesra_normalized = [normalizer.normalize(x) for x in tqdm.tqdm(mesra_collection)]
mesra_normalized
```

    100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 60/60 [00:00<00:00, 191.08it/s]
    




    ['اگر دشنام فرمایی و اگر نفرین دعا گویم',
     'جواب تلخ می\u200cزیبد لب لعل شکرخا را',
     'نصیحت گوش کن جانا که از جان دوست\u200cتر دارند',
     'جوانان سعادتمند پند پیر دانا را',
     'حدیث از مطرب و می گو و راز دهر کمتر جو',
     'که کس نگشود و نگشاید به حکمت این معما را',
     'غزل گفتی و در سفتی بیا و خوش بخوان حافظ',
     'که بر نظم تو افشاند فلک عقد ثریا را',
     'صبا به لطف بگو آن غزال رعنا را',
     'که سر به کوه و بیابان تو داده\u200cای ما را',
     'شکرفروش که عمرش دراز باد چرا',
     'تفقدی نکند طوطی شکرخا را',
     'غرور حسنت اجازت اگر نداد ای گل',
     'که پرسشی نکنی عندلیب شیدا را',
     'به خلق و لطف توان کرد صید اهل نظر',
     'به بند و دام نگیرند مرغ دانا را',
     'ندانم از چه سبب رنگ آشنایی نیست',
     'سهی قدان سیه چشم ماه سیما را',
     'چو با حبیب نشینی و باده پیمایی',
     'به یاد دار محبان بادپیما را',
     'جز این قدر نتوان گفت در جمال تو عیب',
     'که وضع مهر و وفا نیست روی زیبا را',
     'در آسمان نه عجب اگر به گفته حافظ',
     'سرود زهره به رقص آورد مسیحا را',
     'دل می\u200cرود از دستم صاحب دلان خدا را',
     'دردا که راز پنهان خواهد شد آشکارا',
     'کشتی شکستگانیم ای باد شرطه برخیز',
     'باشد که بازبینیم دیدار آشنا را',
     'ده روزه مهر گردون افسانه است و افسون',
     'نیکی به جای یاران فرصت شمار یارا',
     'در حلقه گل و مل خوش خواند دوش بلبل',
     'هات الصبوح هبوا یا ایها السکارا',
     'ای صاحب کرامت شکرانه سلامت',
     'روزی تفقدی کن درویش بی\u200cنوا را',
     'آسایش دو گیتی تفسیر این دو حرف است',
     'با دوستان مروت با دشمنان مدارا',
     'در کوی نیک\u200cنامی ما را گذر ندادند',
     'اگر تو نمی\u200cپسندی تغییر کن قضا را',
     'آن تلخ وش که صوفی ام الخبائثش خواند',
     'اشهی لنا و احلی من قبله العذارا',
     'هنگام تنگدستی در عیش کوش و مستی',
     'که این کیمیای هستی قارون کند گدا را',
     'سرکش مشو که چون شمع از غیرتت بسوزد',
     'دلبر که در کف او موم است سنگ خارا',
     'آیینه سکندر جام می است بنگر',
     'تا بر تو عرضه دارد احوال ملک دارا',
     'خوبان پارسی\u200cگو بخشندگان عمرند',
     'ساقی بده بشارت رندان پارسا را',
     'حافظ به خود نپوشید این خرقه می آلود',
     'ای شیخ پاکدامن معذور دار ما را',
     'به ملازمان سلطان که رساند این دعا را',
     'که به شکر پادشاهی از نظر مران گدا را',
     'از رقیب دیوسیرت به خدای خود پناهم',
     'اگر آن شهاب ثاقب مددی دهد خدا را',
     'مژه سیاهت اگر کرد به خون ما اشارت',
     'از فریب او بیندیش و غلط مکن نگارا',
     'دل عالمی بسوزی چو عذار برفروزی',
     'تو از این چه سود داری که نمی\u200cکنی مدارا',
     'همه شب در این امیدم که نسیم صبحگاهی',
     'به پیام آشنایان بنوازد آشنا را']




```python
# Normalizer on special cases
n = [
    normalizer.normalize('اوفتادم'),
    normalizer.normalize('می ساخته ام'),
    normalizer.normalize('می یافته ام'),
    normalizer.normalize('نمی رفته ای'),
    normalizer.normalize('همی افتیم')
]
print('\n'.join(n))
```

    اوفتادم
    می‌ساخته‌ام
    می‌یافته‌ام
    نمی‌رفته‌ای
    همی‌افتیم
    


```python
from hazm import Lemmatizer

# Lemmatizer on Kohan verbs
lemmatizer = Lemmatizer()
l = [
    lemmatizer.lemmatize('افتادندی'),
    lemmatizer.lemmatize('یافتمی'),
    lemmatizer.lemmatize('می‌نیفتد'),
    lemmatizer.lemmatize('همی‌بیفتید'),
]
print('\n'.join(l))

```

    افتاد#افت
    یافت#یاب
    افتاد#افت
    همی‌بیفتید
    


```python
# Combine lemmitizing with normalizing
n1 = normalizer.normalize('همی افتیم')
l1 = lemmatizer.lemmatize(n1)

n2 = normalizer.normalize('همی بیفتادند')
l2 = lemmatizer.lemmatize(n2)

print(l1,l2)
```

    افتاد#افت افتاد#افت
    


```python
# add Kohan conjugations
lemmatizer.conjugations('افتاد#افت')
```




    ['افتادم',
     'افتادی',
     'افتاد',
     'افتادیم',
     'افتادید',
     'افتادند',
     'نیفتادم',
     'نیفتادی',
     'نیفتاد',
     'نیفتادیم',
     'نیفتادید',
     'نیفتادند',
     'میفتادم',
     'میفتادی',
     'میفتاد',
     'میفتادیم',
     'میفتادید',
     'میفتادند',
     'افتاده\u200cام',
     'افتاده\u200cای',
     'افتاده است',
     'افتاده\u200cایم',
     'افتاده\u200cاید',
     'افتاده\u200cاند',
     'نیفتاده\u200cام',
     'نیفتاده\u200cای',
     'نیفتاده است',
     'نیفتاده\u200cایم',
     'نیفتاده\u200cاید',
     'نیفتاده\u200cاند',
     'میفتاده\u200cام',
     'میفتاده\u200cای',
     'میفتاده است',
     'میفتاده\u200cایم',
     'میفتاده\u200cاید',
     'میفتاده\u200cاند',
     'می\u200cافتادم',
     'می\u200cافتادی',
     'می\u200cافتاد',
     'می\u200cافتادیم',
     'می\u200cافتادید',
     'می\u200cافتادند',
     'نمی\u200cافتادم',
     'نمی\u200cافتادی',
     'نمی\u200cافتاد',
     'نمی\u200cافتادیم',
     'نمی\u200cافتادید',
     'نمی\u200cافتادند',
     'ممی\u200cافتادم',
     'ممی\u200cافتادی',
     'ممی\u200cافتاد',
     'ممی\u200cافتادیم',
     'ممی\u200cافتادید',
     'ممی\u200cافتادند',
     'همی\u200cبیفتادم',
     'همی\u200cبیفتادی',
     'همی\u200cبیفتاد',
     'همی\u200cبیفتادیم',
     'همی\u200cبیفتادید',
     'همی\u200cبیفتادند',
     'می\u200cبیفتادم',
     'می\u200cبیفتادی',
     'می\u200cبیفتاد',
     'می\u200cبیفتادیم',
     'می\u200cبیفتادید',
     'می\u200cبیفتادند',
     'بافتادم',
     'بافتادی',
     'بافتاد',
     'بافتادیم',
     'بافتادید',
     'بافتادند',
     'بافتادمی',
     'بافتادیی',
     'بافتادی',
     'بافتادیمی',
     'بافتادیدی',
     'بافتادندی',
     'افتم',
     'افتی',
     'افتد',
     'افتیم',
     'افتید',
     'افتند',
     'نیفتم',
     'نیفتی',
     'نیفتد',
     'نیفتیم',
     'نیفتید',
     'نیفتند',
     'میفتم',
     'میفتی',
     'میفتد',
     'میفتیم',
     'میفتید',
     'میفتند',
     'می\u200cافتم',
     'می\u200cافتی',
     'می\u200cافتد',
     'می\u200cافتیم',
     'می\u200cافتید',
     'می\u200cافتند',
     'نمی\u200cافتم',
     'نمی\u200cافتی',
     'نمی\u200cافتد',
     'نمی\u200cافتیم',
     'نمی\u200cافتید',
     'نمی\u200cافتند',
     'ممی\u200cافتم',
     'ممی\u200cافتی',
     'ممی\u200cافتد',
     'ممی\u200cافتیم',
     'ممی\u200cافتید',
     'ممی\u200cافتند',
     'بیفتم',
     'بیفتی',
     'بیفتد',
     'بیفتیم',
     'بیفتید',
     'بیفتند',
     'همی\u200cافتم',
     'همی\u200cافتی',
     'همی\u200cافتد',
     'همی\u200cافتیم',
     'همی\u200cافتید',
     'همی\u200cافتند',
     'افتادمی',
     'افتادیی',
     'افتادی',
     'افتادیمی',
     'افتادیدی',
     'افتادندی',
     'همی\u200cنیفتم',
     'همی\u200cنیفتی',
     'همی\u200cنیفتد',
     'همی\u200cنیفتیم',
     'همی\u200cنیفتید',
     'همی\u200cنیفتند',
     'می\u200cنیفتم',
     'می\u200cنیفتی',
     'می\u200cنیفتد',
     'می\u200cنیفتیم',
     'می\u200cنیفتید',
     'می\u200cنیفتند',
     'بیفت',
     'نیفت',
     'میفت']




```python
from hazm.utils import stopwords_list

# Add more stopwords according to the Kohan texts
print(stopwords_list())
```

    ['می\u200cگوید', 'کسی', 'بسیار', 'اما', 'کردن', 'مدت', 'کاملا', 'من', 'فقط', 'امکان', 'متفاوت', 'بودن', 'شوند', 'آنجا', 'سپس', 'کسانی', 'تا', 'بندی', 'کرده_بود', 'وارد', 'پیدا', 'یافته', 'مناسب', 'طبق', 'دار', 'نیاز', 'داشتند', 'آنکه', 'اول', 'حتی', 'رو', 'جدی', 'بیش', 'زیادی', 'کان', 'چون', 'کردم', 'ابتدا', 'آنچه', 'طی', 'همین', 'با', 'افزود', 'فوق', 'حالا', 'پشت', 'مورد', 'بهترین', 'گرفت', 'جمعی', 'است', 'یک', 'سبب', 'ایشان', 'همان', 'سهم', 'تعیین', 'موجب', 'ما', 'چه', 'دو', 'صرف', 'خصوص', 'ممکن', 'منظور', 'خطر', 'نه', 'چگونه', 'نوع', 'بهتر', 'کند', 'خواهد_کرد', 'همچنان', 'می\u200cتوانند', 'سال\u200cهای', 'دیگر', 'غیر', 'شخصی', 'تنها', 'رفت', 'خوب', 'خود', 'براساس', 'اثر', 'پر', 'می\u200cکرد', 'هر', 'یافت', 'آیا', 'نسبت', 'میان', 'رسید', 'بودند', 'گذاری', 'عین', 'بیشتری', 'نیز', 'چیزی', 'بود', 'فکر', 'بین', 'روش', 'کامل', 'فرد', 'کوچک', 'بوده', 'می', 'وگو', 'در', 'اینکه', 'خوبی', 'باره', 'کنم', 'داریم', 'داشته', 'علاوه', 'گفت', 'اکنون', 'بعد', 'کنندگان', 'آوری', 'کنیم', 'آقای', 'کنید', 'پی', 'جریان', 'یابد', 'کمی', 'زیاد', 'کرد', 'آنان', 'می\u200cکردند', 'برای', 'نیمه', 'که', 'شده_بود', 'اگر', 'مهم', 'باشند', 'دادند', 'مانند', 'گرفته_است', 'ریزی', 'تهیه', 'دهد', 'بدون', 'او', 'خیلی', 'زاده', 'طول', 'نخست', 'بوده_است', 'نحوه', 'ساله', 'ترتیب', 'می\u200cشوند', 'راه', 'آنها', 'آخرین', 'همچون', 'شامل', 'برخی', 'را', 'دانست', 'گرفته', 'عدم', 'کنار', 'گر', 'لحاظ', 'اغلب', 'نیست', 'درون', 'همواره', 'سمت', 'هستند', 'شده_اند', 'بیان', 'زیرا', 'گونه', 'بار', 'داشته_است', 'بی', 'داد', 'شما', 'داشتن', 'برداری', 'چهار', 'شان', 'می\u200cتوان', 'نشست', 'رسیدن', 'هنوز', 'شش', 'می\u200cشد', 'تغییر', 'متر', 'آمد', 'دادن', 'یعنی', 'گردد', 'دچار', 'و', 'به', 'کنند', 'بیشتر', 'نبود', 'می\u200cیابد', 'شده', 'وجود', 'گیری', 'متاسفانه', 'بیرون', 'می\u200cدهد', 'اجرا', 'می\u200cکنیم', 'دارای', 'خواهد_بود', 'بسیاری', 'دارند', 'سازی', 'از', 'داده', 'هیچ', 'چند', 'دهه', 'دیگری', 'شد', 'کلی', 'می\u200cکنند', 'چرا', 'هایی', 'تمام', 'جاری', 'خودش', 'لازم', 'وی', 'کرده_است', 'اولین', 'دور', 'تبدیل', 'آن', 'بنابراین', 'هستیم', 'ندارد', 'جمع', 'می\u200cرود', 'زان', 'شمار', 'می\u200cشود', 'روند', 'چیز', 'کس', 'چهارم', 'فردی', 'محسوب', 'هم', 'می\u200cباشد', 'سعی', 'درباره', 'ع', 'گیرد', 'گفته', 'باید', 'نظر', 'داشته_باشد', 'خواهد_شد', 'حدود', 'افرادی', 'بر', 'علیه', 'علت', 'می\u200cگیرد', 'قبل', 'لذا', 'بخش', 'طرف', 'بالا', 'اینجا', 'سراسر', 'جایی', 'خاطرنشان', 'حل', 'اخیر', 'همه', 'یا', 'کافی', 'سی', 'مثل', 'ساز', 'وان', 'شدن', 'همیشه', 'تو', 'سایر', 'ار', 'اش', 'کل', 'جز', 'کرده', 'می\u200cگویند', 'شدند', 'خاص', 'چنین', 'اند', 'تمامی', 'ولی', 'نباید', 'جای', 'برابر', 'باز', 'کرده_اند', 'سالهای', 'می\u200cتواند', 'یکی', 'کردند', 'افراد', 'نوعی', 'عالی', 'نخستین', 'سه', 'طور', 'تعداد', 'رشد', 'هنگام', 'دسته', 'باعث', 'نمی\u200cشود', 'شود', 'می\u200cدهند', 'کدام', 'تحت', 'داده_است', 'شده_است', 'نظیر', 'گاه', 'پس', 'بزرگ', 'جا', 'باشد', 'حداقل', 'عهده', 'جدید', 'روبه', 'حالی', 'کاین', 'البته', 'می\u200cکنم', 'کننده', 'آورد', 'مشخص', 'داشت', 'وقتی', 'می\u200cکند', 'می\u200cرسد', 'یکدیگر', 'خویش', 'شاید', 'قابل', 'این', 'حد', 'گروهی', 'بروز', 'دوباره', 'دیگران', 'یافته_است', 'زیر', 'حال', 'سوی', 'نزدیک', 'دارد', 'پنج', 'امر', 'ضمن', 'نیستند', 'ناشی', 'مر', 'پیش', 'مربوط', 'ز', 'تاکنون', 'می\u200cآید', 'مواجه', 'بخشی', 'شروع', 'بلکه', 'سوم', 'بعضی', 'ندارند', 'همچنین', 'پخش', 'ویژه', 'دوم', 'روی', 'آمده_است', 'کم', 'داشته_باشند', 'دهند', 'آمده']
    


```python
# Detected stopwords of Kohan qazals
tokens = normalizer.tokenizer.tokenize(''.join(mesra_normalized))
stopword_tokens_in_qazals = {t for t in tokens if t in stopwords_list()}
stopword_tokens_in_qazals
```




    {'آن',
     'آورد',
     'از',
     'است',
     'او',
     'اگر',
     'این',
     'با',
     'بر',
     'به',
     'تغییر',
     'تو',
     'جای',
     'خود',
     'دار',
     'دارد',
     'در',
     'دهد',
     'دو',
     'را',
     'روی',
     'سبب',
     'شد',
     'شمار',
     'ما',
     'من',
     'می',
     'می\u200cرود',
     'نظر',
     'نه',
     'نیست',
     'و',
     'چه',
     'چون',
     'کرد',
     'کس',
     'کند',
     'که',
     'گفت',
     'گفته',
     'یا'}




```python

```
